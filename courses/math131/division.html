 <!DOCTYPE html>
<html lang="en">
<head>
  <meta name="description" content="Personal website of Ben Fraser, with math education activities for students and teachers.">
  <meta charset="UTF-8" />
  <title>Division Activity</title>
  <link rel="stylesheet" href="/style.css" />

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
  </script>
</head>
<body>
  <header>
    <h1>Division Activity</h1>
    <div id="nav-placeholder"></div>
      <script>
        fetch("/nav.html")
          .then(response => response.text())
          .then(data => {
            document.getElementById("nav-placeholder").innerHTML = data;
        
            const currentPath = window.location.pathname.replace(/\/index\.html$/, "/");
            const navLinks = document.querySelectorAll("#nav-placeholder a");
        
            navLinks.forEach(link => {
              const linkPath = new URL(link.href).pathname.replace(/\/index\.html$/, "/");
              if (linkPath === currentPath) {
                link.classList.add("active");
              }
            });
          });
      </script>
  </header>
  <main>

    <p>Long division.  Aside from its well-known uses as a torture technique by autocratic nations, we also have to learn it in grade school, as part 
     of some twisted rite of passage.  All kidding aside, it's not as bad as it seems.  The standard algorithm for long division may be one of the 
    first points in your math education where you decided the connection between the algorithm and reality wasn't clear, and decided to just 
    memorize the algorithm, and defer deeper understanding of it.</p>

   <p>But understanding it more deeply, aside from the pedagaogical benefits, also prepares you to do more difficult division problems: the same 
   principles we use in integer division apply to the division of polynomials by one another!  We won't tackle that monstrosity in this class, but 
   rather learn the <i>flexible scaffold</i> method of division - a strategy to slowly chunk away at a division problem.</p>

   <div style="display: flex; justify-content: space-between; gap: 20px; text-align: center;">
      <div style="flex: 1;">
        Flexible scaffold
        \[
       \require{enclose}
       \begin{array}{rr}
       & 3 \hspace{1mm}\\
       & 5 \hspace{1mm}\\
       & 10 \hspace{1mm}\\
       & 10 \hspace{1mm}\\
       8 & \enclose{longdiv}{224} \\
       & \underline{- {\color{ForestGreen}80}} \hspace{1mm}\\
       & 144 \hspace{1mm}\\
       & \underline{- {\color{blue}80}} \hspace{1mm}\\
       & 64 \hspace{1mm}\\
       & \underline{- {\color{purple}40}} \hspace{1mm}\\
       & 24 \hspace{1mm}\\
       & \underline{- {\color{orange}24}} \hspace{1mm}\\
       & 0 \hspace{1mm}
       \end{array}
       \]
      </div>

      <div style="flex: 1;">
        Sum the "partial quotients"
        \[
       \Longrightarrow
       \]
       <figure style="text-align: center;">
          <img src="fig9.png" alt="Flexible scaffold division of 224/28" style="display: inline-block;">
        </figure>
      </div>
    
      <div style="flex: 1;">
        Standard algorithm
        \[
        \require{enclose}
        \begin{array}{rr}
        & 28 \hspace{1mm}\\
        8 & \enclose{longdiv}{224} \\
        & \underline{- 160} \hspace{1mm}\\
        & 64 \hspace{1mm}\\
        & \underline{- 64} \hspace{1mm}\\
        & 0 \hspace{1mm}
        \end{array}
        \]
      </div>
    </div>

      
      <p>In this way, we can reduce the problem into one where we compute a <i>sum</i> of simpler products, which we term "partial quotients", that we 
       are more familiar with (does this strategy seem familiar from the multiplication activity?)  It is up to personal preference what numbers you 
       choose - but like the Price is Right, try picking as large "partial quotients" as you can without <i>going over</i>.  Here are the multiplication 
       tables for your reference:</p>
    

   <div style="display: flex; justify-content: space-between; gap: 20px; text-align: center;">
      <div style="flex: 1;">
        Base-ten multiplication table
        \[
        \begin{array}{|c|cccccccccc|}
        \hline
        \times & 0 & 1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 & 9 \\
        \hline
        0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
        1 & 0 & 1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 & 9 \\
        2 & 0 & 2 & 4 & 6 & 8 & 10 & 12 & 14 & 16 & 18 \\
        3 & 0 & 3 & 6 & 9 & 12 & 15 & 18 & 21 & 24 & 27 \\
        4 & 0 & 4 & 8 & 12 & 16 & 20 & 24 & 28 & 32 & 36 \\
        5 & 0 & 5 & 10 & 15 & 20 & 25 & 30 & 35 & 40 & 45 \\
        6 & 0 & 6 & 12 & 18 & 24 & 30 & 36 & 42 & 48 & 54 \\
        7 & 0 & 7 & 14 & 21 & 28 & 35 & 42 & 49 & 56 & 63 \\
        8 & 0 & 8 & 16 & 24 & 32 & 40 & 48 & 56 & 64 & 72 \\
        9 & 0 & 9 & 18 & 27 & 36 & 45 & 54 & 63 & 72 & 81 \\
        \hline
        \end{array}
        \]
      </div>
    
      <div style="flex: 1;">
        Base-five multiplication table
        \[
        \begin{array}{|c|ccccc|}
        \hline
        \times & 0 & 1 & 2 & 3 & 4 \\
        \hline
        0 & 0 & 0 & 0 & 0 & 0 \\
        1 & 0 & 1 & 2 & 3 & 4 \\
        2 & 0 & 2 & 4 & 11 & 13 \\
        3 & 0 & 3 & 11 & 14 & 22 \\
        4 & 0 & 4 & 13 & 22 & 31 \\
        \hline
        \end{array}
        \]
      </div>
    </div>

    <div id="rule-select" class="styled-checkbox-group">
      <label><input type="checkbox" class="styled-checkbox" id="baseten"> Base-Ten</label>
      <label><input type="checkbox" class="styled-checkbox" id="basefive"> Base-Five</label>
    </div>
    
    <div class="button-container">
      <button id="start-btn" class="rubber-button">Start!</button>
    </div>
    
    <p id="question-text"></p>

    <div id="partial-quotient-container" style="display: none; text-align: center; margin-top: 10px;">
       <input id="partial-quotient-input" type="number" />
   </div>

    <div class="button-container">
      <button id="hint-btn" class="rubber-button">Next</button>
    </div>
    
    <div class="activity-box" id="my-activity">

    </div>

    <div id="final-answer-input" style="text-align: center; margin-top: 1em;"></div>

    <div class="button-container">
      <button id="check-btn" class="rubber-button" style="display: none;">Check Answer</button>
    </div>
    
    <div class="button-container">
      <div id="feedbackText" class="center-feedback"></div>
    </div>





  </main>

  <script>

    // Variable count will keep track of the number of partial quotients successfully input
    let count = 0;
    let partialQuotients = [];


    const ruleCheckboxes = {
      baseten: document.getElementById('baseten'),
      basefive: document.getElementById('basefive'),
    };
    
    Object.values(ruleCheckboxes).forEach(box => {
      box.addEventListener('change', () => {
        // Mutual exclusion for base-ten and base-five
        if (box.id === 'baseten' && box.checked) {
          ruleCheckboxes.basefive.checked = false;
        }
        if (box.id === 'basefive' && box.checked) {
          ruleCheckboxes.baseten.checked = false;
        }
      });
    });

    // a and b are the multiplicands (b is the final answer), c is what we are dividing into, and d is the running total (as we subtract from c)
    let a, b, c, d;
   
    const hintBtn = document.getElementById('hint-btn');
    const hintArea = document.getElementById('hint-area');
    

    const startBtn = document.getElementById('start-btn');
    const questionText = document.getElementById('question-text');
    const activityBox = document.getElementById('my-activity');


    function drawCanvas(mode, inputElements, partialInputElements = []) {
      activityBox.innerHTML = ''; // clear
      const canvas = document.createElement('canvas');
      canvas.width = 1300;
      canvas.height = 650;
      activityBox.appendChild(canvas);
      const ctx = canvas.getContext('2d');
      
      ctx.strokeStyle = 'black';
      ctx.lineWidth = 4;

      if (mode === 1) {
        ctx.strokeRect(375, 80, 550, 550);
        ctx.fillStyle = 'red';
        ctx.fillRect(375, 80, 440, 440);
        ctx.fillStyle = 'skyblue';
        ctx.fillRect(815, 80, 110, 440);
        ctx.fillStyle = 'orange';
        ctx.fillRect(375, 520, 440, 110);
        ctx.fillStyle = 'lime';
        ctx.fillRect(815, 520, 110, 110);
        ctx.strokeRect(375, 80, 440, 440);
        ctx.strokeRect(815, 80, 110, 440);
        ctx.strokeRect(375, 520, 440, 110);
        ctx.strokeRect(815, 520, 110, 110);
      } else if (mode === 2) {
        ctx.fillStyle = 'red';
        ctx.fillRect(450, 80, 320, 390);
        ctx.fillStyle = 'orange';
        ctx.fillRect(770, 80, 80, 390);
        ctx.fillStyle = 'yellow';
        ctx.fillRect(450, 470, 320, 110);
        ctx.fillStyle = 'lime';
        ctx.fillRect(770, 470, 80, 110);
        ctx.fillStyle = 'skyblue';
        ctx.fillRect(450, 580, 320, 50);
        ctx.fillStyle = 'violet';
        ctx.fillRect(770, 580, 80, 50);
        ctx.strokeRect(450, 80, 400, 550);
        ctx.strokeRect(450, 80, 320, 390);
        ctx.strokeRect(770, 80, 80, 390);
        ctx.strokeRect(450, 470, 320, 110);
        ctx.strokeRect(770, 470, 80, 110);
        ctx.strokeRect(450, 580, 320, 50);
        ctx.strokeRect(770, 580, 80, 50);
      } else if (mode === 3) {
        ctx.fillStyle = 'red';
        ctx.fillRect(375, 80, 390, 390);
        ctx.fillStyle = 'orange';
        ctx.fillRect(765, 80, 110, 390);
        ctx.fillStyle = 'yellow';
        ctx.fillRect(875, 80, 50, 390);
        ctx.fillStyle = 'skyblue';
        ctx.fillRect(375, 470, 390, 110);
        ctx.fillStyle = 'lime';
        ctx.fillRect(765, 470, 110, 110);
        ctx.fillStyle = 'violet';
        ctx.fillRect(875, 470, 50, 110);
        ctx.fillStyle = 'pink';
        ctx.fillRect(375, 580, 390, 50);
        ctx.fillStyle = 'rgba(163,114,65,0.8)';
        ctx.fillRect(765, 580, 110, 50);
        ctx.fillStyle = 'lightgray';
        ctx.fillRect(875, 580, 50, 50);
        ctx.strokeRect(375, 80, 550, 550);
        ctx.strokeRect(375, 80, 390, 390);
        ctx.strokeRect(765, 80, 110, 390);
        ctx.strokeRect(875, 80, 50, 390);
        ctx.strokeRect(375, 470, 390, 110);
        ctx.strokeRect(765, 470, 110, 110);
        ctx.strokeRect(875, 470, 50, 110);
        ctx.strokeRect(375, 580, 390, 50);
        ctx.strokeRect(765, 580, 110, 50);
        ctx.strokeRect(875, 580, 50, 50);
      }
    
      // Now draw the label values
      ctx.font = "bold 48px Arial";
      ctx.fillStyle = "black";

      ctx.textAlign = "center"; // default for top labels

    
      inputElements.forEach((input, index) => {
      const val = input.value;
      if (!isNaN(val) && val.trim() !== "") {
        let x = 0, y = 0;
    
        if (mode === 1) {
          if (index === 0) {
            ctx.textAlign = "right"
            x = 370;
            y = 330;
          } else if (index === 1) {
            ctx.textAlign = "right"
            x = 370;
            y = 590;
          } else if (index === 2) {
            ctx.textAlign = "center"
            x = 595;
            y = 70;
          } else if (index === 3) {
            ctx.textAlign = "center"
            x = 870;
            y = 70;
          }
        } else if (mode === 2) {
          if (index === 0) {
            ctx.textAlign = "right"
            x = 440;
            y = 300;
          } else if (index === 1) {
            ctx.textAlign = "right"
            x = 440;
            y = 546;
          } else if (index === 2) {
            ctx.textAlign = "right"
            x = 440;
            y = 623;
          } else if (index === 3) {
            ctx.textAlign = "center"
            x = 613;
            y = 70;
          } else if (index === 4) {
            ctx.textAlign = "center"
            x = 813;
            y = 70;
          }
        } else if (mode === 3) {
          if (index === 0) {
            ctx.textAlign = "right"
            x = 370;
            y = 300;
          } else if (index === 1) {
            ctx.textAlign = "right"
            x = 370;
            y = 546;
          } else if (index === 2) {
            ctx.textAlign = "right"
            x = 370;
            y = 623;
          } else if (index === 3) {
            ctx.textAlign = "center"
            x = 570;
            y = 70;
          } else if (index === 4) {
            ctx.textAlign = "center"
            x = 820;
            y = 70;
          } else if (index === 5) {
            ctx.textAlign = "center"
            x = 900;
            y = 70;
          }
        }
    
        ctx.fillText(val, x, y);
      }
    });

      // Draw partial product values on canvas
      partialInputElements.forEach((input, index) => {
        const val = input.value;
        if (!isNaN(val) && val.trim() !== "") {
          ctx.font = "bold 36px Arial";
          ctx.fillStyle = "black";
          ctx.textAlign = "center";
      
          let x, y;

          if (mode === 1) {
            if (index === 0) {
              ctx.textAlign = "center"
              x = 595;
              y = 320;
              ctx.fillText(val, x, y);
            } else if (index === 1) {
              ctx.textAlign = "center"
              x = 870;
              y = 320;
              ctx.fillText(val, x, y);
            } else if (index === 2) {
              ctx.textAlign = "center"
              x = 595;
              y = 590;
              ctx.fillText(val, x, y);
            } else if (index === 3) {
              ctx.textAlign = "center"
              x = 870;
              y = 590;
              ctx.fillText(val, x, y);
            }
          } else if (mode === 2) {
            if (index === 0) {
              ctx.textAlign = "center"
              x = 613;
              y = 290;
              ctx.fillText(val, x, y);
            } else if (index === 1) {
              ctx.textAlign = "center"
              ctx.save();
              ctx.translate(825, 280); 
              ctx.rotate(-Math.PI / 2); 
              ctx.fillText(val, 0, 0);
              ctx.restore();
            } else if (index === 2) {
              ctx.textAlign = "center"
              x = 613;
              y = 536;
              ctx.fillText(val, x, y);
            } else if (index === 3) {
              ctx.textAlign = "center"
              ctx.save();
              ctx.translate(825, 526); 
              ctx.rotate(-Math.PI / 2); 
              ctx.fillText(val, 0, 0);
              ctx.restore();
            } else if (index === 4) {
              ctx.textAlign = "center"
              x = 613;
              y = 618;
              ctx.fillText(val, x, y);
            } else if (index === 5) {
              ctx.textAlign = "center"
              ctx.save();
              ctx.translate(810, 618); 
              ctx.fillText(val, 0, 0);
              ctx.restore();
            }
          } else if (mode === 3) {
            if (index === 0) {
              ctx.textAlign = "center"
              x = 570;
              y = 290;
              ctx.fillText(val, x, y);
            } else if (index === 1) {
              ctx.textAlign = "center"
              x = 820;
              y = 290;
              ctx.fillText(val, x, y);
            } else if (index === 2) {
              ctx.textAlign = "center"
              ctx.save();
              ctx.translate(915, 280); 
              ctx.rotate(-Math.PI / 2); 
              ctx.fillText(val, 0, 0);
              ctx.restore();
            } else if (index === 3) {
              ctx.textAlign = "center"
              x = 570;
              y = 536;
              ctx.fillText(val, x, y);
            } else if (index === 4) {
              ctx.textAlign = "center"
              x = 820;
              y = 536;
              ctx.fillText(val, x, y);
            } else if (index === 5) {
              ctx.textAlign = "center"
              ctx.save();
              ctx.translate(915, 526); 
              ctx.rotate(-Math.PI / 2); 
              ctx.fillText(val, 0, 0);
              ctx.restore();
            } else if (index === 6) {
              ctx.textAlign = "center"
              x = 570;
              y = 618;
              ctx.fillText(val, x, y);
            } else if (index === 7) {
              ctx.textAlign = "center"
              x = 820;
              y = 618;
              ctx.fillText(val, x, y);
            } else if (index === 8) {
              ctx.textAlign = "center"
              ctx.save();
              ctx.translate(900, 618); 
              ctx.fillText(val, 0, 0);
              ctx.restore();
            }
          }
          
        }
      });


    }








    
  startBtn.addEventListener('click', () => {

      const nextBtn = document.getElementById('hint-btn');
      nextBtn.disabled = true;

      const pqContainer = document.getElementById("partial-quotient-container");
      const pqInput = document.getElementById("partial-quotient-input");
      
      pqInput.value = ""; // clear old value
      pqContainer.style.display = "block"; // show container (and input inside)
      pqInput.focus();

      const feedback = document.getElementById('feedbackText');
      feedback.textContent = '';

      // Play sound when view button is clicked
      const sound = document.getElementById('click-sound');
      if (sound) {
        sound.currentTime = 0; // rewind to start in case it's still playing
        sound.play();
      }

      if (ruleCheckboxes.basefive.checked) {
       a = Math.floor(Math.random() * 3) + 2;
      } else {
       // Generate a single digit number between 2 and 9
       a = Math.floor(Math.random() * 8) + 2;
      }

      b = 0;
      // Ensure that the product of a and b has 4 digits
      if (ruleCheckboxes.basefive.checked) {
       while (a * b < 125) {
          b = Math.floor(Math.random() * 100) + 25;
       }
      } else {
        while (a * b < 1000) {
          b = Math.floor(Math.random() * 900) + 100;
       }
      }

      c = a * b;
      d = c;


      // Display the question
      questionText.textContent = `What is \\(${ruleCheckboxes.basefive.checked ? c.toString(5) : c.toString(10)} \\div 
      ${ruleCheckboxes.basefive.checked ? a.toString(5) : a.toString(10)}\\)?  Input partial quotients below:`;

      MathJax.typeset([questionText]);

      
      // Clear the activity box
      activityBox.innerHTML = '';

    

      //drawCanvas(mode, inputElements, []);




    });


    const checkBtn = document.getElementById('check-btn');
    const feedbackText = document.getElementById('feedbackText');
    
    checkBtn.addEventListener('click', () => {
      // Play click sound
      const sound = document.getElementById('click-sound');
      if (sound) {
        sound.currentTime = 0;
        sound.play();
      }
    
      let correct = true;
    
      // Give feedback
      if (correct) {
        feedbackText.textContent = "Correct!";
        feedbackText.style.color = "green";
      } else {
        feedbackText.textContent = "Incorrect. Try again!";
        feedbackText.style.color = "red";
      }
    });


    hintBtn.addEventListener('click', () => {
      const sound = document.getElementById('click-sound');
      if (sound) {
        sound.currentTime = 0;
        sound.play();
      }

      const pqInput = document.getElementById('partial-quotient-input');
      const pqValue = parseInt(pqInput.value);
      console.log(`Next clicked: pq=${pqValue}, product=${product}, d(before)=${d}`);
  
      if (!isNaN(pqValue)) {
          const product = pqValue * a;
  
          console.log(`Next clicked: pq=${pqValue}, product=${product}, d(before)=${d}`);
  
          if (product <= d) {
              d -= product;
              partialQuotients.push(pqValue);
              count++;
  
              console.log(`Accepted: d(after)=${d}, partialQuotients=${partialQuotients}, count=${count}`);
  
              pqInput.value = ""; // Clear the box
              pqInput.focus();
          } else {
              console.log(`Rejected: product ${product} > d(${d})`);
          }
      } else {
          console.log("Invalid input (not a number)");
      }

  });
  

    
  </script>

  <audio id="click-sound" src="button.mp3" preload="auto"></audio>
  <audio id="set-sound" src="set2.mp3" preload="auto"></audio>
  
</body>
</html>
