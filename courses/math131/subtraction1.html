<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Subtraction Activity 1</title>
  <link rel="stylesheet" href="/math-tools/style.css" />
</head>
<body>
  <header>
    <h1>Subtraction Activity 1</h1>
    <div id="nav-placeholder"></div>
      <script>
        fetch("/math-tools/nav.html")
          .then(response => response.text())
          .then(data => {
            document.getElementById("nav-placeholder").innerHTML = data;
        
            const currentPath = window.location.pathname.replace(/\/index\.html$/, "/");
            const navLinks = document.querySelectorAll("#nav-placeholder a");
        
            navLinks.forEach(link => {
              const linkPath = new URL(link.href).pathname.replace(/\/index\.html$/, "/");
              if (linkPath === currentPath) {
                link.classList.add("active");
              }
            });
          });
      </script>
  </header>
  <main>
    <!-- HEADERS -->
<div class="section-label">Minuend</div>
<div class="section-label">Subtrahend</div>
<div class="section-label">Difference</div>

<!-- ROW 1: Hundreds -->
<div class="block-column">...</div> <!-- Minuend Hundreds -->
<div class="block-column">...</div> <!-- Subtrahend Hundreds -->
<div class="block-column">...</div> <!-- Difference Hundreds -->

<!-- ROW 2: Tens -->
<div class="block-column">...</div> <!-- Minuend Tens -->
<div class="block-column">...</div> <!-- Subtrahend Tens -->
<div class="block-column">...</div> <!-- Difference Tens -->

<!-- ROW 3: Ones -->
<div class="block-column">...</div> <!-- Minuend Ones -->
<div class="block-column">...</div> <!-- Subtrahend Ones -->
<div class="block-column">...</div> <!-- Difference Ones -->


  </main>
  <script>
    const startBtn = document.getElementById("start-btn");
    const problemDiv = document.getElementById("problem");
    const questionText = document.getElementById("question-text");
    const answerInput = document.getElementById("user-answer");
    const checkBtn = document.getElementById("check-answer-btn");
    const feedback = document.getElementById("feedback");
  
    let a = 0;
    let b = 0;
  
    startBtn.addEventListener("click", () => {
      a = Math.floor(Math.random() * 200) + 1;
      b = Math.floor(Math.random() * 200) + 1;
      if (b > a) [a, b] = [b, a];

      // Decompose minuend into base-10
      const hundreds = Math.floor(a / 100);
      const tens = Math.floor((a % 100) / 10);
      const ones = a % 10;

      function renderBlocks(count, containerId, className) {
        const container = document.getElementById(containerId);
      
        // Keep regroup-zone and clear everything else
        Array.from(container.children).forEach(child => {
          if (!child.classList.contains('regroup-zone')) {
            container.removeChild(child);
          }
        });
      
        // Add spacer so blocks stay below regroup zone
        const spacer = document.createElement('div');
        spacer.classList.add('stack-spacer');
        container.appendChild(spacer);
      
        // Add base-ten blocks
        for (let i = 0; i < count; i++) {
          const block = document.createElement('div');
          block.classList.add('block-unit', className);
          container.appendChild(block);
        }
      }


      
      //renderBlocks(hundreds, 'minuend-hundreds', 'block-hundreds');
      //renderBlocks(tens, 'minuend-tens', 'block-tens');
      //renderBlocks(ones, 'minuend-ones', 'block-ones');
      
      //renderBlocks(hundreds, 'difference-hundreds', 'block-hundreds');
      //renderBlocks(tens, 'difference-tens', 'block-tens');
      //renderBlocks(ones, 'difference-ones', 'block-ones');

      
      // Update count labels
      document.getElementById("minuend-hundreds-count").textContent = hundreds;
      document.getElementById("minuend-tens-count").textContent = tens;
      document.getElementById("minuend-ones-count").textContent = ones;
      
      document.getElementById("difference-hundreds-count").textContent = hundreds;
      document.getElementById("difference-tens-count").textContent = tens;
      document.getElementById("difference-ones-count").textContent = ones;
      
      // (Optional: clear Subtrahend column counts)
      ["hundreds", "tens", "ones"].forEach(place => {
        document.getElementById(`subtrahend-${place}-count`).textContent = "0";
      });

    
      questionText.textContent = `What is ${a} âˆ’ ${b}?  (Recall that each place value column must contain between 0 and 9 at the end!)`;
      problemDiv.style.display = "block";
      document.getElementById("block-display").style.display = "flex";
    
      feedback.textContent = "";
      answerInput.value = "";
      answerInput.focus();
    });

  
    checkBtn.addEventListener("click", () => {
      const userAnswer = parseInt(answerInput.value);
      const correct = a - b;
  
      if (isNaN(userAnswer)) {
        feedback.textContent = "Please enter a number!";
        feedback.style.color = "darkred";
      } else if (userAnswer === correct) {
        feedback.textContent = "Correct! ðŸŽ‰";
        feedback.style.color = "green";
      } else {
        feedback.textContent = `Not quite! The correct answer was ${correct}.`;
        feedback.style.color = "#d17f00";
      }
    });
  </script>
</body>
</html>
