<!DOCTYPE html>
<html lang="en">
<head>
  <meta name="description" content="Personal website of Ben Fraser, with math education activities for students and teachers.">
  <meta charset="UTF-8" />
  <title>Unit Conversion Activity</title>
  <link rel="stylesheet" href="/style.css" />

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
  </script>
</head>
<body>
  <header>
    <h1>Unit Conversion Activity</h1>
    <div id="nav-placeholder"></div>
      <script>
        fetch("/nav.html")
          .then(response => response.text())
          .then(data => {
            document.getElementById("nav-placeholder").innerHTML = data;
        
            const currentPath = window.location.pathname.replace(/\/index\.html$/, "/");
            const navLinks = document.querySelectorAll("#nav-placeholder a");
        
            navLinks.forEach(link => {
              const linkPath = new URL(link.href).pathname.replace(/\/index\.html$/, "/");
              if (linkPath === currentPath) {
                link.classList.add("active");
              }
            });
          });
      </script>
  </header>
  <main>

    <h2>Quick Unit Converter</h2>
    <div id="converter-container" style="display: flex; align-items: flex-start; gap: 2em; margin-bottom: 1em;">
      <div id="converter" style="border: 1px solid #ccc; padding: 1em;">
        <label for="unit-category">Category:</label>
        <select id="unit-category">
          <option value="distance">Distance</option>
          <option value="weight">Weight</option>
          <option value="volume">Volume</option>
        </select>
      
        <br><br>
        <label for="from-unit">From:</label>
        <select id="from-unit"></select>
      
        <label for="to-unit" style="margin-left: 1em;">To:</label>
        <select id="to-unit"></select>
      
        <br><br>
        <label for="amount">Amount:</label>
        <input type="number" id="amount" />
      
        <button id="convert-btn" class="rubber-button" style="margin-left: 1em;">Convert</button>
      </div>

      <div id="conversion-output" style="max-width: 700px;">
        <p id="convert-result" style="font-weight: bold;"></p>
        <p id="convert-equation" class="math" style="margin-top: 10px;"></p>
      </div>
    </div>

    <p>We will start with a topic that superficially might seem obvious: what does the word "unit" mean?  We talk about the importance of stating 
    "what are the units?", but why do we call them such?  "Unit" means "One", and when we say "One", one rightly might ask "One what?"... so by adding 
    a suffix to the number (km, mL), we are specifying what "One" we are talking about.</p>

    <p>In this activity, we will combine two problems which often occur simultaneously: conversion between units, and scaling up/down of a 
    recipe.</p>

    <p>We first tackle unit conversion.  The metric system has a handy <i>prefix</i> system, which tells us which power of ten to multiply by 
    in our conversion:
    \[
    \begin{array}{|c|c|}
    \hline
    \text{Prefix} & \text{Multiplier} \\
    \hline
    \text{Mega} & 10^6 \\
    \text{Kilo} & 10^3 \\
    \text{Hecto} & 10^2 \\
    \text{Deca} & 10 \\
    \text{(None)} & 1 \\
    \text{Deci} & 10^{-1} \\
    \text{Centi} & 10^{-2} \\
    \text{Milli} & 10^{-3} \\
    \text{Micro} & 10^{-6} \\
    \hline
    \end{array}
    \]  So for example, a kilometer is equal to one thousand meters, and a meter is equal to one thousand millimeters.  
      (Does this mean Megatron is the equivalent of one million "trons"?  Is Hector the equivalent of a hundred "rs"?)</p>

    <p>This is sufficient information to convert <i>within</i> the metric system.  Unfortunately, we occasionally need to switch into the imperial 
    system, and so need some points of reference (famously, a mission to Mars failed because of some metric/imperial confusion: yes, we should all 
    rightly look with disdain on the imperial system).</p>

    <p>Our reference point will be called our <i>base</i> units: we use them as a home base which we convert into <i>first</i>, and <i>then</i> we convert 
    from there to our destination units (although this seems to be a roundabout way of doing things, it makes things easier to remember).  We will 
    choose our base units to be metres, grams, and millilitres (the first two choices seem obvious, since they are the metric options without prefixes, 
    but millilitres may seem an odd choice... we pick it because there are a lot of commonly used volume units which are much smaller than litres, so 
    it works out more conveniently).  So below, our base units will be given the value 1, and we list the other units by their <b>sizes relative to 
    the base units</b>:</p>


    <div class="button-container">
      <button id="start-btn" class="rubber-button">Start!</button>
    </div>
    
    <p id="question-text"></p>

    <div class="button-container">
      <button id="hint-btn" class="rubber-button">Hint</button>
    </div>
    
    <div id="hint-area" class="math" style="margin-top: 1em;"></div>


    <div id="answer-section" style="margin-top: 20px; text-align: center;">
      <label for="user-answer">Enter your answer:</label>
      <input type="number" id="user-answer" />
      <button id="check-answer-btn" class="rubber-button">Check Answer</button>
      <p id="answer-feedback" style="font-weight: bold; margin-top: 10px;"></p>
    </div>




  </main>
  <script>

    const unitCategory = document.getElementById('unit-category');
    const fromUnit = document.getElementById('from-unit');
    const toUnit = document.getElementById('to-unit');
    const amountInput = document.getElementById('amount');
    const convertBtn = document.getElementById('convert-btn');
    const convertResult = document.getElementById('convert-result');
    
    const unitOptions = {
      distance: {
        "millimeters": 0.001,
        "centimeters": 0.01,
        "meters": 1,
        "kilometers": 1000,
        "inches": 0.0254,
        "feet": 0.3048,
        "yards": 0.9144,
        "miles": 1609.34,
      },
      weight: {
        "milligrams": 0.001,
        "grams": 1,
        "kilograms": 1000,
        "metric tons": 1_000_000,
        "ounces": 28.3495,
        "pounds": 453.592,
      },
      volume: {
        "milliliters": 1,
        "liters": 1_000,
        "teaspoons": 4.92892,
        "tablespoons": 14.7868,
        "fluid ounces": 29.5735,
        "cups": 236.588,
        "pints": 473.176,
        "quarts": 946.353,
        "gallons": 3_785.41
      }
    };

    
    function populateUnits(category) {
      fromUnit.innerHTML = '';
      toUnit.innerHTML = '';
      for (let unit in unitOptions[category]) {
        const option1 = document.createElement('option');
        option1.value = unit;
        option1.textContent = unit;
        const option2 = option1.cloneNode(true);
        fromUnit.appendChild(option1);
        toUnit.appendChild(option2);
      }
    }
    
    unitCategory.addEventListener('change', () => {
      populateUnits(unitCategory.value);
    });
    
    convertBtn.addEventListener('click', () => {
      const category = unitCategory.value;
      const from = fromUnit.value;
      const to = toUnit.value;
      const amount = parseFloat(amountInput.value);
    
      const resultDisplay = document.getElementById('convert-result');
      const equationDisplay = document.getElementById('convert-equation');
    
      if (isNaN(amount)) {
        resultDisplay.textContent = 'Please enter a valid number.';
        resultDisplay.style.color = 'black';
        equationDisplay.textContent = '';
        return;
      }
    
      const fromFactor = unitOptions[category][from];
      const toFactor = unitOptions[category][to];
      const baseAmount = amount * fromFactor;
      const converted = baseAmount / toFactor;
    
      resultDisplay.textContent = `${amount} ${from} = ${converted.toFixed(4)} ${to}`;
    
      // Build a LaTeX-style unit conversion equation
      equationDisplay.textContent = `\\[ ${amount} \\ \\frac{${from}}{1} \\times \\frac{${fromFactor.toFixed(4)}\\ \\text{base}}{1\\ ${from}} \\times \\frac{1\\ ${to}}{${toFactor.toFixed(4)}\\ \\text{base}} = ${converted.toFixed(4)}\\ ${to} \\]`;
    
      MathJax.typeset([equationDisplay]);
    });

    
    // Initial population
    populateUnits(unitCategory.value);


    let m1, m2, m3 = 0;
    
    const hintBtn = document.getElementById('hint-btn');
    const hintArea = document.getElementById('hint-area');
    
    // This array stores your LaTeX hints
    let hintSteps = [];
    let hintIndex = 0;
    
    const startBtn = document.getElementById('start-btn');
    const questionText = document.getElementById('question-text');

    
    let correctAnswer = null;
  
    startBtn.addEventListener('click', () => {

      // Play sound when view button is clicked
      const sound = document.getElementById('click-sound');
      if (sound) {
        sound.currentTime = 0; // rewind to start in case it's still playing
        sound.play();
      }

      // m1 determines metric/imperial direction, m2 determines weight/distance, m3 determines scale up/down
      m1 = Math.floor(Math.random() *2) + 1;
      m2 = Math.floor(Math.random() *2) + 1;
      m3 = Math.floor(Math.random() *2) + 1;

      
      if (m1 === 1) {
        // Here we go metric to imperial
        if (m2 === 1) {
          // Here we go grams to oz
          if (m3 === 1) {
            // Here we scale up

          } else {
            // Here we scale down

          }
        } else {
          // Here we go metres to yards
          if (m3 === 1) {
            // Here we scale up

          } else {
            // Here we scale down

          }
        }
      } else {
        // Here we go imperial to metric
        if (m2 === 1) {
          // Here we go oz to grams
          if (m3 === 1) {
            // Here we scale up

          } else {
            // Here we scale down

          }
        } else {
          // Here we go yards to metres
          if (m3 === 1) {
            // Here we scale up

          } else {
            // Here we scale down

          }
        }
      }

      

      hintSteps = [];
      hintIndex = 0;

      // Here we will generate and store hints
      let i = 0


      let question = "";
      

  
      // Display the question
      questionText.textContent = question;
      MathJax.typeset([questionText]);

      hintIndex = 0;
      hintArea.innerHTML = "";  // Clear previous hints

      
      
    });


    
    document.getElementById('check-answer-btn').addEventListener('click', () => {
      // Play sound when view button is clicked
      const sound = document.getElementById('click-sound');
      if (sound) {
        sound.currentTime = 0; // rewind to start in case it's still playing
        sound.play();
      }
      const userInput = parseInt(document.getElementById('user-answer').value);
      const feedback = document.getElementById('answer-feedback');
    
      if (isNaN(userInput)) {
        feedback.textContent = 'Please enter a number.';
        feedback.style.color = 'black';
      } else if (userInput === correctAnswer) {
        feedback.textContent = 'Correct!';
        feedback.style.color = 'green';
      } else {
        feedback.textContent = 'Incorrect. Try again!';
        feedback.style.color = 'red';
      }
    });



    hintBtn.addEventListener('click', () => {
      // Play sound when view button is clicked
      const sound = document.getElementById('click-sound');
      if (sound) {
        sound.currentTime = 0; // rewind to start in case it's still playing
        sound.play();
      }
      if (hintIndex < hintSteps.length) {
        // Create a new paragraph for each hint
        const hintPara = document.createElement('div');
        hintPara.classList.add('hint-step');
        hintPara.textContent = hintSteps[hintIndex];
        hintArea.appendChild(hintPara);
        
        MathJax.typeset([hintPara]);
        hintIndex++;
      }
    });




    
  </script>

  <audio id="click-sound" src="button.mp3" preload="auto"></audio>
  <audio id="set-sound" src="set2.mp3" preload="auto"></audio>

</body>
</html>
